# Bookstore 接口文档

## 目录
- [通用说明](#通用说明)
- [用户模块](#用户模块)
- [图书模块](#图书模块)
- [购物车模块](#购物车模块)
- [管理模块](#管理模块)
- [会话模块](#会话模块)

---

## 通用说明

### 基础信息
- **基础URL**: `http://localhost:8080`
- **数据格式**: JSON
- **字符编码**: UTF-8

### 响应格式
所有接口统一返回以下格式：

```json
{
  "code": 200,      
  "message": "success",  
  "data": {}     
}
```

**响应码说明**：
- `200`: 操作成功
- `0`: 操作失败


### 分页响应格式
```json
{
  "curPage": 1,    
  "pageSize": 10,     
  "totalCount": 100,      
  "totalPage": 10,       
  "data": []      
}
```

### 认证说明
- 部分接口需要在请求头中携带JWT Token进行身份验证
- Token通过登录接口获取
- 需要在请求头中添加：`token: {token}`

---

## 用户模块

### 1. 用户注册

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/users/register` |
| 请求方式 | `POST` |
| 接口描述 | 新用户注册 |
| 是否需要认证 | 否 |

**请求参数**

请求体为User对象，包含以下字段：

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| username | String | 是 | 用户名 |
| password | String | 是 | 密码 |

**请求示例**
```bash
POST /api/users/register
Content-Type: application/json

{
  "username": "newuser",
  "password": "123456"
}
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

失败响应：
```json
{
  "code": 0,
  "message": "注册失败",
  "data": null
}
```

### 2. 用户登录

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/users/login` |
| 请求方式 | `POST` |
| 接口描述 | 用户登录验证 |
| 是否需要认证 | 否 |

**请求参数**

请求体为User对象，包含以下字段：

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| username | String | 是 | 用户名 |
| password | String | 是 | 密码 |

**请求示例**
```bash
POST /api/users/login
Content-Type: application/json

{
  "username": "testuser",
  "password": "123456"
}
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```

失败响应：
```json
{
  "code": 0,
  "message": "用户不存在或密码错误",
  "data": null
}
```

**说明**
- 成功响应中的`data`字段为JWT Token字符串
- Token需要保存并在后续请求中使用

### 3. 获取用户信息

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/users/{uid}` |
| 请求方式 | `GET` |
| 接口描述 | 根据用户ID获取用户信息 |
| 是否需要认证 | 是 |

**请求参数**

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| uid | Long | 是 | 用户ID（路径参数） |

**请求示例**
```bash
GET /api/users/10001
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**响应示例**
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "uid": 10001,
    "username": "testuser",
    "password": "******",
    "status": 1,
    "role": 1
  }
}
```

### 4. 更新用户信息

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/users/{uid}` |
| 请求方式 | `PUT` |
| 接口描述 | 更新用户信息 |
| 是否需要认证 | 是 |

**请求参数**

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| uid | Long | 是 | 用户ID（路径参数） |

请求体为User对象，包含需要更新的用户信息

**请求示例**
```bash
PUT /api/users/10001
Content-Type: application/json
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

{
  "username": "updateduser",
  "password": "newpassword"
}
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

失败响应：
```json
{
  "code": 0,
  "message": "更新用户信息失败",
  "data": null
}
```

### 5. 购买图书

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/users/buy` |
| 请求方式 | `GET` |
| 接口描述 | 购买指定数量的图书 |
| 是否需要认证 | 是 |

**请求参数**

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| bid | Long | 是 | 图书ID（查询参数） |
| number | Integer | 是 | 购买数量（查询参数） |

**请求示例**
```bash
GET /api/users/buy?bid=10001&number=2
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

失败响应：
```json
{
  "code": 0,
  "message": "购买失败",
  "data": null
}
```

---

## 图书模块

### 1. 获取图书列表

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/books/list` |
| 请求方式 | `GET` |
| 接口描述 | 获取所有图书列表 |
| 是否需要认证 | 否 |

**请求参数**
无

**响应示例**
```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": 1,
      "bid": 10001,
      "title": "Java编程思想",
      "author": "Bruce Eckel",
      "description": "Java编程经典教材",
      "publish": "机械工业出版社",
      "coverUrl": "/images/book1.jpg",
      "tags": "Java,编程",
      "price": 89.00,
      "stock": 100,
      "sales": 500
    }
  ]
}
```

### 2. 分页查询图书

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/books` |
| 请求方式 | `GET` |
| 接口描述 | 分页查询图书列表 |
| 是否需要认证 | 否 |

**请求参数**

| 参数 | 类型 | 必填 | 默认值 | 描述 |
|---|---|---|---|---|
| page | Integer | 是 | 1 | 页码 |
| size | Integer | 是 | 10 | 每页大小 |

**请求示例**
```bash
GET /api/books?page=1&size=20
```

**响应示例**
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "curPage": 1,
    "pageSize": 20,
    "totalCount": 100,
    "totalPage": 5,
    "data": [
      {
        "id": 1,
        "bid": 10001,
        "title": "Java编程思想",
        "author": "Bruce Eckel",
        "description": "Java编程经典教材",
        "publish": "机械工业出版社",
        "coverUrl": "/images/book1.jpg",
        "tags": "Java,编程",
        "price": 89.00,
        "stock": 100,
        "sales": 500
      }
    ]
  }
}
```

### 3. 搜索图书

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/books/search` |
| 请求方式 | `GET` |
| 接口描述 | 根据条件搜索图书 |
| 是否需要认证 | 否 |

**请求参数**

| 参数 | 类型 | 必填 | 默认值 | 描述 |
|---|---|---|---|---|
| page | Integer | 否 | null | 页码（不传则返回所有结果） |
| size | Integer | 否 | null | 每页大小（不传则返回所有结果） |
| keyword | String | 否 | null | 搜索关键词（匹配书名） |
| author | String | 否 | null | 作者名称 |
| tags | String | 否 | null | 标签 |
| isStock | Boolean | 否 | false | 是否仅看有库存 |

**请求示例**

不分页查询：
```bash
GET /api/books/search?keyword=Java&author=Bruce
```

分页查询：
```bash
GET /api/books/search?page=1&size=10&keyword=Java&isStock=true
```

**响应示例**

分页响应：
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "curPage": 1,
    "pageSize": 10,
    "totalCount": 30,
    "totalPage": 3,
    "data": [
      {
        "id": 1,
        "bid": 10001,
        "title": "Java编程思想",
        "author": "Bruce Eckel",
        "description": "Java编程经典教材",
        "publish": "机械工业出版社",
        "coverUrl": "/images/book1.jpg",
        "tags": "Java,编程",
        "price": 89.00,
        "stock": 100,
        "sales": 500
      }
    ]
  }
}
```

不分页响应（直接返回数组）：
```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": 1,
      "bid": 10001,
      "title": "Java编程思想",
      "author": "Bruce Eckel",
      "description": "Java编程经典教材",
      "publish": "机械工业出版社",
      "coverUrl": "/images/book1.jpg",
      "tags": "Java,编程",
      "price": 89.00,
      "stock": 100,
      "sales": 500
    }
  ]
}
```

---

## 购物车模块

### 1. 更新购物车

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/carts/{bid}` |
| 请求方式 | `PUT` |
| 接口描述 | 更新购物车中指定图书的数量（如果图书不存在则添加） |
| 是否需要认证 | 是 |

**请求参数**

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| bid | Long | 是 | 图书ID（路径参数） |

请求体为Integer类型，表示图书数量

**请求示例**
```bash
PUT /api/carts/10001
Content-Type: application/json
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

3
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

失败响应：
```json
{
  "code": 0,
  "message": "更新图书失败",
  "data": null
}
```

### 2. 删除购物车中的图书

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/carts/{bid}` |
| 请求方式 | `DELETE` |
| 接口描述 | 从购物车中删除指定图书 |
| 是否需要认证 | 是 |

**请求参数**

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| bid | Long | 是 | 图书ID（路径参数） |

**请求示例**
```bash
DELETE /api/carts/10001
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

失败响应：
```json
{
  "code": 0,
  "message": "删除图书失败",
  "data": null
}
```

### 3. 清空购物车

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/carts/clear` |
| 请求方式 | `DELETE` |
| 接口描述 | 清空当前用户的购物车 |
| 是否需要认证 | 是 |

**请求参数**
无

**请求示例**
```bash
DELETE /api/carts/clear
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

失败响应：
```json
{
  "code": 0,
  "message": "清空购物车失败",
  "data": null
}
```

---

## 管理模块

### 1. 创建用户

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/admin/user` |
| 请求方式 | `POST` |
| 接口描述 | 管理员创建新用户 |
| 是否需要认证 | 是（管理员权限） |

**请求参数**

请求体为User对象，包含以下字段：

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| username | String | 是 | 用户名 |
| password | String | 是 | 密码 |
| status | Integer | 否 | 用户状态（默认为1） |
| role | Integer | 否 | 用户角色（默认为1） |

**请求示例**
```bash
POST /api/admin/user
Content-Type: application/json
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

{
  "username": "newuser",
  "password": "123456",
  "status": 1,
  "role": 1
}
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

失败响应：
```json
{
  "code": 0,
  "message": "创建用户失败",
  "data": null
}
```

### 2. 删除用户

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/admin/user/{uid}` |
| 请求方式 | `DELETE` |
| 接口描述 | 管理员删除指定用户 |
| 是否需要认证 | 是（管理员权限） |

**请求参数**

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| uid | Long | 是 | 用户ID（路径参数） |

**请求示例**
```bash
DELETE /api/admin/user/10001
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": "用户删除成功"
}
```

失败响应：
```json
{
  "code": 0,
  "message": "删除用户失败",
  "data": null
}
```

### 3. 获取用户列表

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/admin/users/list` |
| 请求方式 | `GET` |
| 接口描述 | 获取所有用户列表 |
| 是否需要认证 | 是（管理员权限） |

**请求参数**
无

**响应示例**
```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "id": 1,
      "uid": 10001,
      "username": "admin",
      "password": "******",
      "status": 1,
      "role": 0
    }
  ]
}
```

### 4. 分页查询用户

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/admin/users` |
| 请求方式 | `GET` |
| 接口描述 | 分页查询用户列表 |
| 是否需要认证 | 是（管理员权限） |

**请求参数**

| 参数 | 类型 | 必填 | 默认值 | 描述 |
|---|---|---|---|---|
| page | Integer | 否 | 1 | 页码 |
| size | Integer | 否 | 10 | 每页大小 |

**请求示例**
```bash
GET /api/admin/users?page=1&size=20
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**响应示例**
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "curPage": 1,
    "pageSize": 20,
    "totalCount": 100,
    "totalPage": 5,
    "data": [
      {
        "id": 1,
        "uid": 10001,
        "username": "admin",
        "password": "******",
        "status": 1,
        "role": 0
      }
    ]
  }
}
```

### 5. 添加图书

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/admin/book` |
| 请求方式 | `POST` |
| 接口描述 | 管理员添加新图书 |
| 是否需要认证 | 是（管理员权限） |

**请求参数**

请求体为Book对象，包含以下字段：

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| bid | Long | 否 | 图书编号（唯一，系统自动生成） |
| title | String | 是 | 图书标题 |
| author | String | 否 | 作者 |
| description | String | 否 | 图书描述 |
| publish | String | 否 | 出版社 |
| coverUrl | String | 否 | 封面图片URL |
| tags | String | 否 | 标签，逗号分隔 |
| price | Double | 否 | 价格 |
| stock | Integer | 否 | 库存数量 |
| sales | Integer | 否 | 销量 |

**请求示例**
```bash
POST /api/admin/book
Content-Type: application/json
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

{
  "title": "Java编程思想",
  "author": "Bruce Eckel",
  "description": "Java编程经典教材",
  "publish": "机械工业出版社",
  "coverUrl": "/images/book1.jpg",
  "tags": "Java,编程",
  "price": 89.00,
  "stock": 100,
  "sales": 0
}
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": "图书添加成功"
}
```

失败响应：
```json
{
  "code": 0,
  "message": "添加图书失败",
  "data": null
}
```

### 6. 更新图书信息

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/admin/book/{bid}` |
| 请求方式 | `PUT` |
| 接口描述 | 管理员更新图书信息 |
| 是否需要认证 | 是（管理员权限） |

**请求参数**

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| bid | Long | 是 | 图书ID（路径参数） |

请求体为Book对象，包含需要更新的图书信息

**请求示例**
```bash
PUT /api/admin/book/10001
Content-Type: application/json
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

{
  "id": 1,
  "bid": 10001,
  "title": "Java编程思想（第5版）",
  "author": "Bruce Eckel",
  "description": "更新后的描述",
  "price": 99.00,
  "stock": 150
}
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": "图书更新成功"
}
```

失败响应：
```json
{
  "code": 0,
  "message": "更新图书信息失败",
  "data": null
}
```

### 7. 封禁用户

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/admin/ban/{uid}` |
| 请求方式 | `GET` |
| 接口描述 | 管理员封禁指定用户 |
| 是否需要认证 | 是（管理员权限） |

**请求参数**

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| uid | Long | 是 | 用户ID（路径参数） |

**请求示例**
```bash
GET /api/admin/ban/10001
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": "用户封禁成功"
}
```

失败响应：
```json
{
  "code": 0,
  "message": "封禁用户失败",
  "data": null
}
```

### 8. 解封用户

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/api/admin/unban/{uid}` |
| 请求方式 | `GET` |
| 接口描述 | 管理员解封指定用户 |
| 是否需要认证 | 是（管理员权限） |

**请求参数**

| 参数 | 类型 | 必填 | 描述 |
|---|---|---|---|
| uid | Long | 是 | 用户ID（路径参数） |

**请求示例**
```bash
GET /api/admin/unban/10001
token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": "用户解封成功"
}
```

失败响应：
```json
{
  "code": 0,
  "message": "解封用户失败",
  "data": null
}
```

---

## 会话模块

### 1. 设置Cookie

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/setCookie` |
| 请求方式 | `GET` |
| 接口描述 | 设置会话Cookie（测试接口） |
| 是否需要认证 | 否 |

**请求参数**
无

**请求示例**
```bash
GET /setCookie
```

**响应示例**
```json
{
  "code": 200,
  "message": "success",
  "data": null
}
```

**说明**
- 此接口会在响应中设置名为`sessionId`的Cookie，值为`123456789`
- 主要用于测试Cookie功能

### 2. 获取Cookie

**基本信息**

| 字段 | 描述 |
|---|---|
| 接口路径 | `/getCookie` |
| 请求方式 | `GET` |
| 接口描述 | 获取会话Cookie（测试接口） |
| 是否需要认证 | 否 |

**请求参数**
无

**请求示例**
```bash
GET /getCookie
Cookie: sessionId=123456789
```

**响应示例**

成功响应：
```json
{
  "code": 200,
  "message": "success",
  "data": "Session ID: 123456789"
}
```

失败响应：
```json
{
  "code": 0,
  "message": "No session ID found",
  "data": null
}
```

---

## 数据模型

### User（用户）

| 字段 | 类型 | 描述 |
|---|---|---|
| id | Integer | 主键ID（自增） |
| uid | Long | 用户唯一标识 |
| username | String | 用户名 |
| password | String | 密码（加密存储） |
| status | Integer | 用户状态（1-正常，0-封禁） |
| role | Integer | 用户角色（0-管理员，1-普通用户） |

### Book（图书）

| 字段 | 类型 | 描述 |
|---|---|---|
| id | Integer | 主键ID（自增） |
| bid | Long | 图书唯一标识 |
| title | String | 图书标题 |
| author | String | 作者 |
| description | String | 图书描述 |
| publish | String | 出版社 |
| coverUrl | String | 封面图片URL |
| tags | String | 标签（逗号分隔） |
| price | Double | 价格 |
| stock | Integer | 库存数量 |
| sales | Integer | 销量 |

### Cart（购物车）

| 字段 | 类型 | 描述 |
|---|---|---|
| uid | Long | 用户ID |
| bid | Long | 图书ID |
| number | Integer | 图书数量 |

---

## 错误码说明

| 错误码 | 描述 |
|---|---|
| 200 | 操作成功 |
| 0 | 操作失败 |

## 注意事项

1. 所有需要认证的接口均需要在请求头中携带JWT Token
2. 管理员接口需要管理员权限（role=0）
3. 对于分页接口，如果不传递分页参数，部分接口会返回所有结果
4. 删除操作不可恢复，请谨慎使用
5. 购物车相关操作会自动识别当前登录用户（通过JWT Token）
6. 购买图书时会自动扣除库存并更新销量

## 更新记录

| 版本 | 日期 | 更新内容 |
|---|---|---|
| v1.0 | 2024-12-XX | 初始版本，完成基础接口文档编写 |

